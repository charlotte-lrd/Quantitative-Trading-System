{"version":3,"sources":["webpack:///./src/components/Backtest.vue?02cf","webpack:///./src/components/Backtest.vue","webpack:///./src/components/Backtest.vue?de88"],"names":["id","class","action","method","enctype","type","name","value","asset_code","placeholder","start_time","end_time","frequency","backtest","retreat","getStrategy","asset","investvalue","TR","ATR_param","k","N","DT_param","ATR_bounds","Unit","width","height","margin","top","right","bottom","left","r","c","strategy","flag","computed","this","methods","console","log","s","path","a","get","then","res","data","catch","error","i","length","push","Math","max","abs","d3","slice","d","prev_price","remove","g","append","attr","b","that","xscale","domain","range","innerWidth","yscale","innerHeight","yaxis","ticks","tickSize","tickPadding","xaxis","tickFormat","call","selectAll","g2","line","x","y","curve","sel","size","colors","x0","x1","bars","sc","enter","watch","getInvestvalue","toFixed","Scale","Draw","__exports__","render"],"mappings":"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","file":"js/chunk-361a486a.da5220d6.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./Backtest.vue?vue&type=style&index=0&id=2e0265c1&scoped=true&lang=css\"","<template>\n    <div id = \"Tip\">\n      <div class=\"panel-header\">回测结果</div>\n      <div class=\"panel-header-end\"></div>\n      <svg id = \"Classics\"  class=\"classic\" style = 'width:810px; height:370px'>\n      </svg>\n      <div class=\"tooltip\"></div>\n      <div class=\"tooltip2\"></div>\n      <!--button id = 'ATR' @click = 'getATR(),Scale(),Draw()'>ATR</button-->\n      <!--button id = 'DT' @click = 'trial()'>Dual Thrust</button-->\n      <input class=\"asset-code\" type=\"text\" v-model.lazy = \"asset_code\" placeholder=\"Input Asset Code\">\n      <input class=\"time-start\" type=\"text\" v-model.lazy = \"start_time\" placeholder=\"Input Start Time\">\n      <input class=\"time-end\" type=\"text\" v-model.lazy = \"end_time\" placeholder=\"Input End Time\">\n      <input class=\"time-frequency\" type=\"text\" v-model.lazy = \"frequency\" placeholder=\"Input Frequency\">\n      <div class = \"time-button\" @click=\"backtest()\" type=\"submit\">Backtest</div>\n      <div class = \"indexes\">最大回撤：{{retreat }}</div>\n      <form action=\"strategy=custom\" method=post enctype=multipart/form-data>\n         <input class=\"custom-strategy file\" type=file name=file>\n         <input  class=\"custom-strategy upload\" type=submit value=Upload>\n      </form>\n    </div>\n    <div class=\"content-left\">\n      <div class=\"seg\"></div>\n      <div class=\"nav\">\n        <div class=\"nav-menu\">\n          <div class=\"nav-title\">经典策略</div>\n          <div class=\"nav-content\">\n            <a id=\"R-breaker\" @click='getStrategy(\"R_breaker\")'>R-breaker</a>\n            <a id=\"ATR\" @click='getStrategy(\"ATR\")'>ATR</a>\n            <a id=\"Dual Thrust\" @click='getStrategy(\"Dual_Thrust\")'>Dual Thrust</a>\n          </div>\n        </div>\n      </div>\n    </div>\n  </template>\n  \n  <script>\n  import axios from 'axios'\n  import * as d3 from 'd3'\n  \n  export default {\n    name:'Backtest',\n    data(){\n      return {\n        asset:[],\n        retreat:\"\",\n        investvalue:[],\n        TR:[],\n        ATR_param:{\n          k:10,\n          N:20\n        },\n        DT_param:{\n          k:5\n        },\n        ATR_bounds:[],\n        Unit:[],\n        width: 780,\n        height: 330,\n        margin:{\n          top:40,\n          right:20,\n          bottom:10,\n          left:55\n        },\n        r:10,\n        c:20,\n        asset_code:\"\",\n        start_time:\"\",\n        end_time:\"\",\n        frequency:\"\",\n        strategy:\"\",\n        flag:0\n      }\n    },\n    mounted(){\n\n    },\n    computed:{\n      innerWidth(){\n        return this.width - this.margin.left - this.margin.right\n      },\n      innerHeight(){\n        return this.height - this.margin.top - this.margin.bottom\n      }\n    },\n    methods:{\n       trial(){\n        this.flag+=1;\n        console.log(this.flag);\n       },\n       getStrategy(s){\n        this.strategy=s;\n       },\n       backtest(){\n        const path = \"http://127.0.0.1:5000/\"+this.asset_code+\"/st=\"+this.start_time+\"ed=\"+this.end_time+\"freq=\"+this.frequency+\"/strategy=\"+this.strategy;\n        axios\n           .get(path)\n           .then(res => {\n             this.asset=res.data;\n             console.log(this.asset);\n           })\n           .catch(error => {\n             console.error(error);\n           });\n           console.log(this.asset);\n       },\n       getAsset(){\n        const path = 'http://127.0.0.1:5000/Sample/A';\n        axios\n           .get(path)\n           .then(res => {\n             this.asset=res.data;\n             console.log(this.asset);\n             this.flag += 1;\n             console.log(this.flag);\n           })\n           .catch(error => {\n             console.error(error);\n           });\n\n       },\n       getATR(){\n        let i = 0;\n        while(i < this.asset.length){\n          this.TR.push(Math.max(this.asset[i]['high']-this.asset[i]['low'],Math.abs(this.asset[i]['high']-this.asset[i]['PDC']),Math.abs(this.asset[i]['PDC']-this.asset[i]['low'])));\n          i = i + 1;\n        }\n        console.log(this.TR)\n        i = 0;\n        while(i < this.asset.length){\n          if(i>=this.ATR_param.k){\n            if(i >= this.ATR_param.N - 1){\n              let s = {};\n              s['Up'] = d3.max(this.asset.slice(i-this.ATR_param.k,i),function(d){return d['high']});\n              s['Down'] = d3.min(this.asset.slice(i-this.ATR_param.k,i),function(d){return d['low']});\n              s['ATR'] = d3.mean(this.TR.slice(i-this.ATR_param.N+1,i+1));\n              this.ATR_bounds.push(s);\n            }\n            else{\n              let s = {};\n              s['Up'] = d3.max(this.asset.slice(i-this.ATR_param.k,i),function(d){return d['high']});\n              s['Down'] = d3.min(this.asset.slice(i-this.ATR_param.k,i),function(d){return d['low']});\n              s['ATR'] = 0;\n              this.ATR_bounds.push(s);\n            }\n          }else{\n            if(i >= this.ATR_param.N - 1){\n              let s = {};\n              s['Up'] = 0;\n              s['Down'] = 0;\n              s['ATR'] = d3.mean(this.asset.slice(i-this.ATR_param.N+1,i+1));\n              this.ATR_bounds.push(s);\n            }\n            else{\n              let s = {};\n              s['Up'] = 0;\n              s['Down'] = 0;\n              s['ATR'] = 0;\n              this.ATR_bounds.push(s);\n            }\n          }\n          i = i + 1;\n        }\n        console.log(this.ATR_bounds);\n        i = 0;\n        while(i<this.ATR_bounds.length){\n          this.Unit.push(0);\n          i = i + 1;\n        }\n        i = 0;\n        let prev_price = this.asset[0]['current'];\n        while(i<this.ATR_bounds.length){\n          if (i==0) {\n            if (this.asset[i]['current']>this.ATR_bounds[i]['Up']) {\n              prev_price = this.asset[i]['current'];\n              this.Unit[i] += 1;\n            }else{\n              if (this.asset[i]['current']<this.ATR_bounds[i]['Down']){\n                prev_price = this.asset[i]['current'];\n                this.Unit[i] -= 1;\n              }\n            }\n          }else{\n            if(this.Unit[i-1]==0){\n              if (this.asset[i]['current']>this.ATR_bounds[i]['Up']) {\n                prev_price = this.asset[i]['current'];\n                this.Unit[i]=this.Unit[i-1]+1;\n              }else{\n                if (this.asset[i]['current']<this.ATR_bounds[i]['Down']) {\n                  prev_price = this.asset[i]['current'];\n                  this.Unit[i] =  this.Unit[i-1]-1;\n                }\n              }\n            }\n            if (this.Unit[i-1]>0) {\n              if (this.asset[i]['current']>prev_price+0.5*this.ATR_bounds[i]['ATR']){\n                this.Unit[i] = this.Unit[i-1]+1;\n                prev_price = this.asset[i]['current'];\n              }else{\n                if(this.asset[i]['current']<prev_price-2*this.ATR_bounds[i]['ATR']){\n                  this.Unit[i] = 0;\n                }else{\n                  if(this.asset[i]['current']<this.ATR_bounds[i]['Down']){\n                  this.Unit[i] = 0;\n                }\n              }\n            }\n          }\n          if (this.Unit[i-1]<0) {\n              if (this.asset[i]['current'] < prev_price - 0.5*this.ATR_bounds[i]['ATR']){\n                this.Unit[i] = this.Unit[i-1]-1;\n                prev_price = this.asset[i]['current'];\n              }else{\n                if(this.asset[i]['current'] > prev_price + 2*this.ATR_bounds[i]['ATR']){\n                  this.Unit[i] = 0;\n                }else{\n                  if(this.asset[i]['current']>this.ATR_bounds[i]['Up']){\n                  this.Unit[i] = 0;\n                }\n              }\n            }\n          }\n        }\n        i = i+1;\n      }\n      console.log(this.Unit);\n\n      i = 0;\n      while(i<this.asset.length){\n        if(i==0)\n          this.investvalue.push(this.asset[i]['current']*this.Unit[i]);\n        else\n          this.investvalue.push(this.investvalue[i-1]+this.asset[i]['current']*this.Unit[i]);\n        i = i + 1;\n      }\n      console.log(this.investvalue);\n      },\n\n      getInvestvalue(){\n        console.log(\"getinvest\");\n        let i = 0;\n        while(i<this.asset.length){\n          this.investvalue.push(this.asset[i]['total_cash']);\n          i = i + 1;\n        }\n        console.log(this.investvalue);\n      },\n\n      //Scale函数用来画出坐标轴\n       Scale(){\n        d3.select('#classicscale').remove()\n        const g = d3.select('#Classics').append('g').attr('id', 'classicscale')\n                    .attr('transform', `translate(${this.margin.left},${this.margin.top})`);\n        var [a,b] = d3.extent(this.investvalue);\n        let that = this;\n        const xscale = d3.scaleLinear()\n                         .domain([0,that.investvalue.length])\n                         .range([0, this.innerWidth]);\n        const yscale = d3.scaleLinear()\n                         .domain([b,a])\n                         .range([0, this.innerHeight]);\n        console.log([a,b])\n        const yaxis = d3.axisLeft(yscale)\n                        .ticks(10)\n                        .tickSize(5)\n                        .tickPadding(5);\n\n        const xaxis = d3.axisBottom(xscale)\n                      .ticks(20)\n                      .tickSize(-5)\n                      .tickPadding(-15)\n                      .tickFormat(function(d){\n                        //return i;\n                        //console.log(that.asset[d]['trade_time'])\n                        return d<that.asset.length?that.asset[d]['date'].slice(5,10):that.asset[d-1]['date'].slice(5,10);\n                      })\n\n                     g.append('g').call(yaxis)\n                      .attr('id' ,'yaxis');\n                     g.append('g').call(xaxis)\n                      .attr('id', 'xaxis')\n                      \n                     d3.select('#xaxis')\n                       .selectAll('.tick')\n                       .selectAll('text')\n                       .attr(\"font-size\",\"9px\");\n  \n    },\n       //ATR strategy的函数实现\n       Draw(){        \n        d3.select('#classicCurve').remove()\n\n        //选择id为'Classics'的svg，增添g并取id为classicCurve，移动画布使其与设置的margin对其\n        const g2 = d3.select('#Classics').append('g').attr('id', 'classicCurve')\n                    .attr('transform', `translate(${this.margin.left},${this.margin.top})`);\n        \n        //防止代码中将this错认为当前数据，用that代替全局的this\n        let that = this;\n\n        //设置旗帜为ATR，表示按下了ATR按钮\n        that.flag=\"ATR\";\n        \n        //设置x轴、y轴的映射函数，将数据映射到x、y轴坐标上\n        var [a,b] = d3.extent(this.investvalue);\n        const xscale = d3.scaleLinear()\n                         .domain([0,that.investvalue.length])\n                         .range([0, this.innerWidth]);\n        const yscale = d3.scaleLinear()\n                         .domain([b,a])\n                         .range([0, this.innerHeight]);\n\n        //设置折线图的映射函数，会将数据映射为每个点的坐标/每条线段的路径值\n        const line = d3.line()\n                       .x(function(d,i){return xscale(i)})\n                       .y(function(d){return yscale(d)})\n                       .curve(d3.curveLinear)\n      \n        //在g上增添路径path，并将目标画线的数据传入line映射函数中\n        g2.append('path')\n          .attr('d',line(that.investvalue))\n          .attr('fill','none')\n          .attr('stroke',\"#3366ff\")\n          //.attr(\"transform\", function(d) {\n          //  return `translate(${xscale(d['id'])+1.5},${yscale(d['price'])-5})`;\n          //})\n          //.on(\"mouseover\",function(){\n          //   let d =d3.select(this).data();\n          //   console.log(d);\n          //   var str = 'value:' + d[0];\n          //   var t = 60 + yscale(d[0])\n            \n          //   d3.selectAll('.tooltip')\n          //     .html(str)\n          //     .style(\"left\", (xscale(d[0]['id'])+35)+\"px\")\n          //     .style(\"top\", (t+270)+\"px\")\n          //     .style(\"opacity\",1.0);\n          //})\n          //.on(\"mouseleave\",function(){\n          //   d3.selectAll('.tooltip')\n          //     .style(\"opacity\",0.0);\n          //})\n       },\n\n       //Dual Thrust strategy的函数实现\n       DT(){\n        d3.select('#classicCurve').remove()\n        console.log(\"Dual Thrust\")\n       },\n       \n    colorbox(sel, size, colors){\n      var [x0,x1] = d3.extent( colors.domain());\n      var bars = d3.range( x0, x1, (x1-x0)/size[1]);\n      var sc = d3.scaleLinear()\n          .domain([x0,x1]).range([0, size[1]]);\n      sel.selectAll(\"line\").data(bars).enter().append(\"line\")\n        .attr(\"x1\", 0).attr(\"x2\",size[0])\n        .attr(\"y1\", sc).attr(\"y2\",sc)\n        .attr(\"stroke\",colors);\n      \n      sel.append(\"rect\")\n          .attr(\"width\",size[0]).attr(\"height\",size[1])\n          .attr(\"fill\",\"none\").attr(\"stroke\",\"black\")\n        }\n    },\n    created(){\n      //this.getAsset();\n    },\n    beforeUnmount() {\n    },\n    watch:{\n      asset(){\n        // console.log(\"getasset\");\n        this.getInvestvalue();\n        this.retreat = d3.max(this.asset,function(d){return d['retreat']}).toFixed(2);\n        this.Scale();\n        this.Draw();\n    }\n  }\n  };\n  </script>\n  \n  <style scoped>\n  .tooltip{\n      position: absolute;\n      padding-left:5px;\n      padding-right:5px;\n      width:auto;\n      height:auto;\n      border:1px solid #2ea44f;\n      border-radius:5px;\n      background-color: white;\n      font-size: 8px;\n      text-align: center;\n      opacity:0;\n      z-index:999;\n          }\n  \n  .tooltip2{\n    position:absolute;\n    left:0px;\n    top:0px;\n    width:auto;\n    height:auto;\n    border:2px solid lightcoral;\n    border-radius:5px;\n    padding-left:1px;\n    padding-right:1px;\n    padding-top:1px;\n    padding:1px;\n    background-color: white;\n    font-size: 1px;\n    text-align: center;\n    opacity:0;\n    z-index:99;\n  }\n  .panel-header {\n    position: absolute;\n    top: 90px;\n    left:170px;\n    padding: 2px 2px-2px 20px;\n    width: 60px;\n    height: 22px;\n    line-height: 18px;\n    font-size: 6px;\n    text-align: right;\n    background: #415c68;\n    color: #fcfcfc;\n    display: flex;\n    justify-content:space-evenly;\n    align-items: center;\n    align-content:stretch;\n    font-weight: bold;\n    border-radius: 1px;\n    box-shadow: 0 1px 2px rgba(26 26 26 0.2);\n    z-index:99;\n  }\n  \n  .panel-header-end {\n    position: absolute;\n    top: 90px;\n    left:230px;\n    border-top: 22px solid #455a64;\n    border-right: 22px solid #ffffff;\n    border-bottom: 0px solid #ffffff;\n    z-index:98;\n  }\n  .asset-code{\n  position: absolute;\n  top: 50px;\n  left:205px;\n  width: 125px;\n  height: 18px;\n  border-top: 5px solid #455a64;\n  border-bottom: 2px solid #455a64;\n  z-index:98;\n  }\n  .time-start{\n  position: absolute;\n  top: 50px;\n  left:340px;\n  width: 125px;\n  height: 18px;\n  border-top: 5px solid #455a64;\n  border-bottom: 2px solid #455a64;\n  z-index:98;\n}\n\n  .time-end{\n  position: absolute;\n  top: 50px;\n  left:475px;\n  width: 125px;\n  height: 18px;\n  border-top: 5px solid #455a64;\n  border-bottom: 2px solid #455a64;\n  z-index:98;\n}\n  .time-frequency{\n  position: absolute;\n  top: 50px;\n  left:610px;\n  width: 100px;\n  height: 18px;\n  border-top: 5px solid #455a64;\n  border-bottom: 2px solid #455a64;\n  z-index:98;\n  }\n  .time-button{\n  display: flex;\n  position: absolute;\n  top: 50px;\n  left:725px;\n  width: 90px;\n  height: 25px;\n  appearance: none;\n  background-color: #455a64;\n  border: 1px solid rgba(27, 31, 35, .15);\n  border-radius: 5px;\n  box-shadow: rgba(27, 31, 35, .1) 0 1px 0;\n  box-sizing: border-box;\n  color: #fff;\n  cursor: pointer;\n  display: inline-block;\n  font-family: -apple-system,system-ui,\"Segoe UI\",Helvetica,Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\";\n  font-size: 15px;\n  font-weight: 520;\n  line-height: 10px;\n  padding: 5px 5px;\n  text-align: center;\n  text-decoration: none;\n  justify-content:space-evenly;\n  align-items: center;\n  align-content:stretch;\n  user-select: none;\n  -webkit-user-select: none;\n  touch-action: manipulation;\n  vertical-align: middle;\n  white-space: nowrap;\n  }\n  .content-left{\n    width:12%;\n    height:600px;\n    background-color: #1c232f;\n    float:left;\n  }\n  .left-title{\n    height:50px;\n    width:10px;\n  }\n  .left-title>a{\n    display: block;\n    width:100%;\n    height:50px;\n    line-height: 50px;\n    text-align:center;\n    color:white;\n    text-decoration: none;\n  }\n  .seg{\n    height:1px;\n    width:100%;\n    background-color: black;\n  }\n  .nav{\n    margin-top:5px;\n  }\n  .nav-title{\n    height:40px;\n    width:100%;\n    color:white;\n    text-align:center;\n    line-height:40px;\n    cursor:pointer;\n  }\n  .nav-content{\n    width:100%;\n    height:100%;\n    background-color: #0c1119;\n  }\n  .nav-content>a{\n    display:block;\n    height:30px;\n    width:100%;\n    color:#CCCCCC;\n    text-decoration: none;\n    text-align:center;\n    line-height:30px;\n  }\n  .nav-content>a:hover{\n    display:block;\n    height:30px;\n    width:100%;\n    color:#ffffff;\n    text-decoration: none;\n    text-align:center;\n    line-height:30px;\n    background-color: #12040c;\n  }\n  .custom-strategy{\n    position:absolute;\n    top:520px;\n  }\n  .file{\n    left:200px;\n  }\n  .upload{\n    left:400px;\n  }\n  .indexes{\n    position: absolute;\n    left: 1000px;\n    top:200px;\n  }\n  </style>\n  ","import { render } from \"./Backtest.vue?vue&type=template&id=2e0265c1&scoped=true\"\nimport script from \"./Backtest.vue?vue&type=script&lang=js\"\nexport * from \"./Backtest.vue?vue&type=script&lang=js\"\n\nimport \"./Backtest.vue?vue&type=style&index=0&id=2e0265c1&scoped=true&lang=css\"\n\nimport exportComponent from \"C:\\\\Users\\\\lrd\\\\Quantitative-Trading-System-main\\\\Framework\\\\Frontend\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-2e0265c1\"]])\n\nexport default __exports__"],"sourceRoot":""}